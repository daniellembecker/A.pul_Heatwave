"0",""
"0",""
"0","#set quantile values"
"0","q <- c(0.25, 0.75)"
"0",""
"0","# calculate quantile values by time and Treatment groups"
"0","Quants <- Blch %>%"
"0","  group_by(treatment, Photo_date) %>%"
"0","  summarize(quant25 = quantile(Bleaching.Score, probs = q[1]),"
"0","            quant75 = quantile(Bleaching.Score, probs = q[2]),"
"0","            IQRbyGroup=IQR(Bleaching.Score))"
"2","`summarise()` has grouped output by 'treatment'. You can override using the `.groups` argument."
"0","# add a group name by pasting Time and Treatment"
"0","Quants$group <-paste0(Quants$treatment,""_"", Quants$Photo_date)"
"0",""
"0","#Calculate Quantile upper and lower ranges "
"0","Quants$upper <-  Quants$quant75+1.5*Quants$IQRbyGroup # Upper Range  "
"0","Quants$lower <- Quants$quant25-1.5*Quants$IQRbyGroup # Lower Range"
"0",""
"0","#join outlier cutoffs with rate data"
"0","data <- left_join(Blch, Quants)"
"2","Joining with `by = join_by(treatment, Photo_date, group)`"
"0","#remove outliers from rates"
"0","data <- data %>%"
"0","  filter(Bleaching.Score < upper) %>%"
"0","  filter(Bleaching.Score > lower) "
"0",""
"0","# Visualize data following outlier removal"
"0","r_plot<-data %>%"
"0","    ggplot(., aes(x = Photo_date, y = Bleaching.Score, colour=treatment)) +"
"0","    geom_point(aes(fill=treatment, group=interaction(treatment, Photo_date)), pch = 21, size=2, alpha=0.5) + "
"0","    xlab(""Time Point"") + "
"0","    scale_fill_manual(name=""treatment"", values=c(""#3450A3"",""#E9A33D""))+"
"0","    scale_color_manual(name=""treatment"", values=c(""#3450A3"",""#E9A33D""))+"
"0","    ylab(""Color Score"") +"
"0","    theme_classic() + "
"0","    theme(legend.position=""none"","
"0","      axis.title=element_text(face=""bold"", size=16),"
"0","      axis.text=element_text(size=12, color=""black""), "
"0","      legend.title=element_text(face=""bold"", size=14), "
"0","      legend.text=element_text(size=12)); r_plot"
"0",""
