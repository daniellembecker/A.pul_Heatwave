"0","# Function to plot isoform positions and expression for a given gene
plot_isoforms <- function(gene) {
  # Filter isoforms for the given gene
  gene_isoforms <- isoform_positions %>%
    filter(gene == !!gene) %>%
    mutate(isoform = as.character(isoform))
  
  # Extract isoform expression values
  isoform_expr_values <- isoform_expr[gene_isoforms$isoform, ]
  
  # Create a data frame for plotting
  plot_data <- data.frame(
    isoform = gene_isoforms$isoform,
    expression = rowMeans(isoform_expr_values)
  )
  
  # Plot isoform expression
  ggplot(plot_data, aes(x = isoform, y = expression)) +
    geom_bar(stat = ""identity"") +
    labs(x = ""Isoform"", y = ""Mean Expression"", title = paste(""Gene:"", gene)) +
    theme_minimal()
}; plot_isoforms
"
"1","function(gene) {
"
"1","  # Filter isoforms for the given gene
"
"1","  gene_isoforms <- isoform_positions %>%
"
"1","    filter(gene == !!gene) %>%
"
"1","    mutate(isoform = as.character(isoform))
"
"1","  
"
"1","  # Extract isoform expression values
"
"1","  isoform_expr_values <- isoform_expr[gene_isoforms$isoform, ]
"
"1","  
"
"1","  # Create a data frame for plotting
"
"1","  plot_data <- data.frame(
"
"1","    isoform = gene_isoforms$isoform,
"
"1","    expression = rowMeans(isoform_expr_values)
"
"1","  )
"
"1","  
"
"1","  # Plot isoform expression
"
"1","  ggplot(plot_data, aes(x = isoform, y = expression)) +
"
"1","    geom_bar(stat = ""identity"") +
"
"1","    labs(x = ""Isoform"", y = ""Mean Expression"", title = paste(""Gene:"", gene)) +
"
"1","    theme_minimal()
"
"1","}
"
